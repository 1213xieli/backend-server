webpackJsonp([15],{L9Ac:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("IHPB"),s=a.n(i),n=a("teIl"),r=a("Lpv+"),o=a("U6mY"),c=a("W1T5"),l=a("GE2/"),d=a("wesB"),h=a("wSez"),m={name:"needBalanceRecord",data:function(){return{allLoaded:!1,bottomStatus:"",pageNumber:1,pageSize:10,recordList:[{recordTitle:"",recordTime:"",recordState:"",rcordId:"",billStatusIndex:""}],endtime:"",starttime:"",state:"",wrapperHeight:0,switchSelectStatusPopup:!1,statusTypeSlots:[{values:[{name:"进行中",id:1},{name:"已完成",id:2},{name:"已取消",id:3}],textAlign:"center"}]}},components:{RecordList:o.a,myHeader:n.a,NoRecord:c.a,filterTime:r.a},created:function(){this._getBalanceRecordList({endtime:this.endtime,starttime:this.starttime,state:this.state,pageNumber:1,pageSize:this.pageSize})},mounted:function(){this.wrapperHeight=document.documentElement.clientHeight-this.$refs.wrapper.getBoundingClientRect().top},methods:{handlerLeft:function(t){this.gotoDetail(t)},handlerIcon:function(t){this.gotoDetail(t)},handlerBtn:function(t){console.log(t),this.cancelApply(t)},gotoDetail:function(t){this.$router.push("/needBalanceDetail?rcordId="+t)},_getBalanceRecordList:function(t){var e=this;h.Indicator.open({text:"加载中...",spinnerType:"fading-circle"}),Object(l.h)(t).then(function(t){if(t.data){var a=t.data.map(function(t,e){return{recordTitle:t.number,recordTime:t.bizdate,recordState:d.a.recordState[t.state],rcordId:t.rcordId,billStatusIndex:t.billStatusIndex}});e.recordList=a,e.recordList.length<e.pageSize&&(e.allLoaded=!0)}else e.recordList=[];h.Indicator.close()},function(t){h.Indicator.close()})},selectFilterDate:function(){this.$refs.filterTime.selectFilterDate()},onTimeChangeFilter:function(t){var e=t.starttime,a=t.endtime;this._getBalanceRecordList({endtime:a,starttime:e,pageNumber:1,pageSize:this.pageSize,state:this.state})},handleConfirm:function(){this.state=this.$refs.picker.getValues()[0].id,this._getBalanceRecordList({endtime:this.endtime,starttime:this.starttime,pageNumber:1,pageSize:this.pageSize,state:this.state}),this.switchSelectStatusPopup=!1},handleReset:function(){this.state="",this.starttime="",this.endtime="",this._getfeedRecordList({endtime:this.endtime,starttime:this.starttime,pageNumber:1,pageSize:this.pageSize,state:this.state}),this.switchSelectStatusPopup=!1},selectFilterStatus:function(){this.switchSelectStatusPopup=!this.switchSelectStatusPopup},handleBottomChange:function(t){this.bottomStatus=t},loadBottom:function(){var t=this;console.log("下来"),this.pageNumber++,Object(l.h)({endtime:this.endtime,starttime:this.starttime,pageNumber:this.pageNumber,pageSize:this.pageSize,state:this.state}).then(function(e){var a=e.data.map(function(t,e){return{recordTitle:t.number,recordTime:t.feedDate,recordState:d.a.recordState[t.state],rcordId:t.rcordId,billStatusIndex:t.billStatusIndex}});a.length<t.pageSize?t.allLoaded=!0:t.allLoaded=!1,t.recordList=[].concat(s()(t.recordList),s()(a)),t.$refs.loadmore.onBottomLoaded()},function(e){t.allLoaded=!0})},cancelApply:function(t){var e=this;this.$messagebox.confirm("确定执行此操作?").then(function(a){Object(l.c)(t).then(function(){e.$toast({message:"取消成功！",duration:1e3})},function(){}),e._getBalanceRecordList({endtime:e.endtime,starttime:e.starttime,state:e.state,pageNumber:1,pageSize:e.pageSize})})}}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"needBalanceRecord",staticStyle:{"max-width":"100%","box-sizing":"border-box"}},[a("myHeader",{attrs:{isBack:!0,backPath:"/needBalance",title:"记录列表"}}),t._v(" "),a("div",{staticClass:"seat-head"}),t._v(" "),a("div",{staticClass:"filter-block"},[a("div",{staticClass:"left",on:{click:t.selectFilterDate}},[a("span",{staticClass:"filter-item"},[t._v("日期筛选")]),t._v(" "),a("span",[t._v("▼")])]),t._v(" "),a("div",{staticClass:"right"},[a("span",{staticClass:"filter-item",on:{click:t.selectFilterStatus}},[t._v("状态筛选")]),t._v(" "),a("span",[t._v("▼")])])]),t._v(" "),a("div",{staticClass:"list-container"},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.recordList.length,expression:"recordList.length"}],ref:"wrapper",staticClass:"page-loadmore-wrapper",style:{height:t.wrapperHeight+"px"}},[a("mt-loadmore",{ref:"loadmore",attrs:{"bottom-method":t.loadBottom,"auto-fill":!1,"bottom-all-loaded":t.allLoaded},on:{"bottom-status-change":t.handleBottomChange}},[a("RecordList",{attrs:{listData:t.recordList},on:{"on-handlerIcon":t.handlerIcon,"on-handlerBtn":t.handlerBtn,"on-handlerLeft":t.handlerLeft}})],1)],1)]),t._v(" "),a("filter-time",{ref:"filterTime",on:{"on-filter-search":t.onTimeChangeFilter}}),t._v(" "),a("div",{staticClass:"my-prop"},[a("mt-popup",{attrs:{position:"bottom"},model:{value:t.switchSelectStatusPopup,callback:function(e){t.switchSelectStatusPopup=e},expression:"switchSelectStatusPopup"}},[a("mt-picker",{ref:"picker",attrs:{slots:t.statusTypeSlots,"value-key":"name","show-toolbar":!0}},[a("span",{staticClass:"sure-btn",on:{click:t.handleConfirm}},[t._v("确认")]),t._v(" "),a("span",{staticClass:"reset-btn",on:{click:t.handleReset}},[t._v("重置筛选")])])],1)],1),t._v(" "),t.recordList.length?t._e():a("NoRecord")],1)},staticRenderFns:[]};var p=a("C7Lr")(m,u,!1,function(t){a("kiTi")},"data-v-eeb0e954",null);e.default=p.exports},kiTi:function(t,e){}});
//# sourceMappingURL=15.f6ad9c99a877aced8756.js.map
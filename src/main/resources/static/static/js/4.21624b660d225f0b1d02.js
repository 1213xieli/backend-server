webpackJsonp([4],{"501J":function(t,e){},JDeg:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("4YfN"),n=i.n(s),a=i("X1H5"),c=i.n(a),o=i("teIl"),r=i("pzWD"),l=i("y6zN"),d=i("w3CS"),u=i("GE2/"),h=i("9rMa"),p=i("wSez"),m={name:"getMedicine",mixins:[i("PnOK").a],data:function(){return{batchNumber:"",batchId:"",switchBatchNumPopup:!1,batchNumSlots:[{values:[{id:"",name:""}],textAlign:"center"}],applyDateText:Object(l.a)(new Date,"yyyy-MM-dd"),applyDate:new Date,needMedicineReason:"",needMedicineReasonId:"",switchTalking:!1,switchNeedMedicinePopup:!1,needMedicineSlots:[{values:[{id:1,name:"免疫"},{id:2,name:"保健"},{id:3,name:"抗应激"},{id:4,name:"治疗"},{id:5,name:"消毒"},{id:6,name:"器械"}],textAlign:"center",defaultIndex:1}],isNeedOther:!0,isNotNeedOther:!1,isShowEntrust:!1,isEntrust:!1,clientName:"",clientID:"",entrustorId:"",switchEntrustPopup:!1,needEntrustSlots:[{values:[{id:"",name:"",idcard:""}],textAlign:"center",defaultIndex:0}],localId:"",serverId:"",isShowBroadcastBtn:!1,switchIcon:!0,switchIcon1:!0}},components:{SubmitBtn:r.a,myHeader:o.a},created:function(){this._getBatchNumberList(),this._initData()},mounted:function(){this.initWxConfig()},computed:n()({},Object(h.b)(["signature"])),methods:{_initData:function(){this.needMedicineReason=this.needMedicineSlots[0].values[1].name,this.needMedicineReasonId=this.needMedicineSlots[0].values[1].id},selectBatchNum:function(){this.batchNumSlots[0].values[0].name?this.switchBatchNumPopup=!this.switchBatchNumPopup:this.$toast({message:"无可选批次，请核实业务场景！",duration:1e3})},showTalking:function(){this.switchTalking=!this.switchTalking},_getBatchNumberList:function(){var t=this;p.Indicator.open({text:"加载中...",spinnerType:"fading-circle"}),Object(u.i)().then(function(e){p.Indicator.close(),e.data&&e.data.length&&(t.batchNumSlots[0].values=e.data.map(function(t,e){return{name:t.name,id:t.id}}),t.batchNumber=t.batchNumSlots[0].values[0].name,t.batchId=t.batchNumSlots[0].values[0].id)}).catch(function(t){p.Indicator.close()})},_queryEntrustList:function(){var t=this;Object(u.p)().then(function(e){p.Indicator.close();var i=e.data;i&&i.list.length?(t.isShowEntrust=!0,t.needEntrustSlots[0].values=i.list.map(function(t){return{name:t.name,id:t.id,idcard:t.idcard}}),t.clientName=t.needEntrustSlots[0].values[0].name,t.clientID=t.needEntrustSlots[0].values[0].idcard,t.entrustorId=t.needEntrustSlots[0].values[0].id):(t.$toast({message:"无委托人信息，请维护养户档案！",duration:1e3}),t.isNeedOther=!0,t.isNotNeedOther=!1,t.isEntrust=!1,t.isShowEntrust=!1,p.Indicator.close())}).catch(function(e){t.isNeedOther=!0,t.isNotNeedOther=!1,t.isEntrust=!1,t.isShowEntrust=!1,t.$toast({message:"无委托人信息，请维护养户档案！",duration:1e3}),p.Indicator.close()})},handleBatchConfirm:function(){this.batchNumber=this.$refs.batchPicker.getValues()[0].name,this.batchId=this.$refs.batchPicker.getValues()[0].id,this.switchBatchNumPopup=!1},selectApplyDate:function(){this.$refs.applyDatePicker.open()},applyDateConfirm:function(t){this.applyDateText=Object(l.a)(t,"yyyy-MM-dd")},selectNeedMedicineReason:function(){this.switchNeedMedicinePopup=!this.switchNeedMedicinePopup},handleNeedMedicineConfirm:function(){this.needMedicineReason=this.$refs.needMedicinePicker.getValues()[0].name,this.needMedicineReasonId=this.$refs.needMedicinePicker.getValues()[0].id,this.switchNeedMedicinePopup=!1},selectEntrust:function(){this.needEntrustSlots[0].values[0].name?this.switchEntrustPopup=!this.switchEntrustPopup:this.$toast({message:"无委托人信息，请维护养户档案！",duration:1e3})},handleEntrustConfirm:function(){this.clientName=this.$refs.entrustPicker.getValues()[0].name,this.clientID=this.$refs.entrustPicker.getValues()[0].idcard,this.entrustorId=this.$refs.entrustPicker.getValues()[0].id,this.switchEntrustPopup=!1},switchNeedOtherHandler:function(t){"isNeedOther"===t?this.isNeedOther||(this.isNeedOther=!0,this.isNotNeedOther=!1,this.isEntrust=!1):"isNotNeedOther"===t&&(this.isNotNeedOther||(this.isNotNeedOther=!0,this.isNeedOther=!1,this.isEntrust=!0,this._queryEntrustList()))},_saveDrug:function(){var t=this,e={batchId:this.batchId,batchNo:this.batchNumber,applydate:this.applyDateText,recipientReason:this.needMedicineReasonId,serverId:this.serverId,isEntrust:this.isEntrust,entrustIdcard:this.clientID,entrustName:this.clientName,entrustNameId:this.entrustorId};Object(u.v)(e).then(function(e){t.$toast({message:"提交成功！",duration:1e3}),t.isDisabledSubmit=!1,t.submitBtnText="提交",t.$router.push("/getMedicineRecord")}).catch(function(e){t.isDisabledSubmit=!1,t.submitBtnText="提交"})},submitPageData:function(){Object(d.b)([{val:this.batchNumber,rule:["required"],getTipText:"批次号"},{val:this.serverId,rule:["required"],getTipText:"语音说话"}])&&(this.isDisabledSubmit||(this.isDisabledSubmit=!0,this.submitBtnText="提交中...",this._saveDrug()))},initWxConfig:function(){c.a.config({debug:!1,appId:this.signature.appId,timestamp:this.signature.timestamp,nonceStr:this.signature.nonceStr,signature:this.signature.signature,jsApiList:["startRecord","stopRecord","onVoiceRecordEnd","playVoice","pauseVoice","stopVoice","onVoicePlayEnd","uploadVoice"]})},cancelTalking:function(){this.switchTalking=!1},finishTalking:function(){this.switchTalking=!1,this.switchIcon=!0,this.switchIcon1=!0,this.pauseTalking()},stopTalking:function(){var t=this;this.isShowBroadcastBtn=!0,this.switchIcon=!0,c.a.stopRecord({success:function(e){t.localId=e.localId,c.a.uploadVoice({localId:t.localId,success:function(e){t.serverId=e.serverId}})},fail:function(t){}})},startTalking:function(){var t=this;this.switchIcon=!1,c.a.startRecord({success:function(){},cancel:function(){t.$toast({message:"用户拒绝授权录音！",duration:500})}})},playAudio:function(){c.a.playVoice({serverId:this.serverId,localId:this.localId})},resetTalking:function(){this.isShowBroadcastBtn=!1,this.switchIcon=!0,this.switchIcon1=!0,this.localId="",this.serverId="",this.pauseTalking()},broadcastTalking:function(){this.switchIcon1=!1,c.a.playVoice({serverId:this.serverId,localId:this.localId})},pauseTalking:function(){this.switchIcon1=!0,c.a.pauseVoice({localId:this.localId,serverId:this.serverId})}}},v={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"getMedicine",staticStyle:{"max-width":"100%","box-sizing":"border-box"}},[s("myHeader",{attrs:{isBack:!0,backPath:"/business",title:"我要领药",subtitle:"记录",subtitlePath:"/getMedicineRecord"}}),t._v(" "),s("div",{staticClass:"seat-head"}),t._v(" "),s("div",{staticClass:"list-block"},[s("mt-cell",{attrs:{title:"批次号："},nativeOn:{click:function(e){return t.selectBatchNum(e)}}},[t._v("\n      "+t._s(t.batchNumber)+"\n      "),s("span",{staticClass:"img"})]),t._v(" "),s("mt-cell",{attrs:{title:"申请日期："},nativeOn:{click:function(e){return t.selectApplyDate(e)}}},[s("span",{staticClass:"color-text"},[t._v("\n        "+t._s(t.applyDateText)+"\n      ")]),t._v(" "),s("span",{staticClass:"img"})]),t._v(" "),s("mt-cell",{attrs:{title:"领药原因："},nativeOn:{click:function(e){return t.selectNeedMedicineReason(e)}}},[t._v("\n      "+t._s(t.needMedicineReason)+"\n      "),s("span",{staticClass:"img"})]),t._v(" "),s("mt-cell",{attrs:{title:"语音说话："}},[s("span",{directives:[{name:"show",rawName:"v-show",value:t.isShowBroadcastBtn,expression:"isShowBroadcastBtn"}],staticStyle:{display:"inline-block",padding:"0 0.25rem","margin-right":"32px"},on:{click:t.playAudio}},[s("img",{staticStyle:{width:".23rem"},attrs:{src:i("Jj7Z")}})]),t._v(" "),s("img",{attrs:{src:i("bimD")},on:{click:t.showTalking}})])],1),t._v(" "),s("div",{staticClass:"select-type"},[s("div",{staticClass:"title"},[t._v("\n      是否委托他人领取\n    ")]),t._v(" "),s("div",{staticClass:"radio-select-box"},[s("div",{staticClass:"radio-item"},[s("span",[t._v("否")]),t._v(" "),t.isNeedOther?s("img",{attrs:{src:i("yS0J")},on:{click:function(e){return t.switchNeedOtherHandler("isNeedOther")}}}):s("img",{attrs:{src:i("Xjmz")},on:{click:function(e){return t.switchNeedOtherHandler("isNeedOther")}}})]),t._v(" "),s("div",{staticClass:"radio-item"},[s("span",[t._v("是")]),t._v(" "),t.isNotNeedOther?s("img",{attrs:{src:i("yS0J")},on:{click:function(e){return t.switchNeedOtherHandler("isNotNeedOther")}}}):s("img",{attrs:{src:i("Xjmz")},on:{click:function(e){return t.switchNeedOtherHandler("isNotNeedOther")}}})])]),t._v(" "),t.isNotNeedOther&&t.isShowEntrust?s("div",[s("mt-cell",{attrs:{title:"委托领取人姓名："},nativeOn:{click:function(e){return t.selectEntrust(e)}}},[t._v("\n        "+t._s(t.clientName)+"\n        "),s("span",{staticClass:"img"})]),t._v(" "),s("mt-cell",{attrs:{title:"委托领取人身份证号：",value:t.clientID}})],1):t._e()]),t._v(" "),s("SubmitBtn",{attrs:{btnText:t.submitBtnText,customStyle:t.myCustomStyle},nativeOn:{click:function(e){return e.preventDefault(),t.submitPageData()}}}),t._v(" "),s("div",{staticClass:"my-prop"},[s("mt-popup",{attrs:{position:"bottom"},model:{value:t.switchBatchNumPopup,callback:function(e){t.switchBatchNumPopup=e},expression:"switchBatchNumPopup"}},[s("mt-picker",{ref:"batchPicker",attrs:{slots:t.batchNumSlots,"value-key":"name","show-toolbar":!0}},[s("span",{staticClass:"sure-btn",on:{click:t.handleBatchConfirm}},[t._v("确认")])])],1),t._v(" "),s("mt-popup",{attrs:{position:"bottom"},model:{value:t.switchNeedMedicinePopup,callback:function(e){t.switchNeedMedicinePopup=e},expression:"switchNeedMedicinePopup"}},[s("mt-picker",{ref:"needMedicinePicker",attrs:{slots:t.needMedicineSlots,"value-key":"name","show-toolbar":!0}},[s("span",{staticClass:"sure-btn",on:{click:t.handleNeedMedicineConfirm}},[t._v("确认")])])],1),t._v(" "),s("mt-popup",{attrs:{position:"bottom"},model:{value:t.switchEntrustPopup,callback:function(e){t.switchEntrustPopup=e},expression:"switchEntrustPopup"}},[s("mt-picker",{ref:"entrustPicker",attrs:{slots:t.needEntrustSlots,"value-key":"name","show-toolbar":!0}},[s("span",{staticClass:"sure-btn",on:{click:t.handleEntrustConfirm}},[t._v("确认")])])],1)],1),t._v(" "),s("mt-popup",{ref:"talking",staticClass:"talking-container",attrs:{position:"bottom"},model:{value:t.switchTalking,callback:function(e){t.switchTalking=e},expression:"switchTalking"}},[s("div",{staticClass:"talking-pop"},[s("div",{staticClass:"talkingHeader"},[s("div",{staticClass:"left",on:{click:t.cancelTalking}},[t._v("取消")]),t._v("\n        录音\n        "),s("div",{staticClass:"right",on:{click:t.finishTalking}},[t._v("完成")])]),t._v(" "),s("div",{staticClass:" talking-body"},[s("div",{staticClass:"control"},[t.isShowBroadcastBtn?t._e():s("span",{staticClass:"stop",on:{click:t.stopTalking}},[t._v("停止")]),t._v(" "),t.isShowBroadcastBtn?s("span",{staticClass:"stop",on:{click:t.pauseTalking}},[t._v("暂停")]):t._e(),t._v(" "),!t.isShowBroadcastBtn&&t.switchIcon?s("span",{staticClass:"start",on:{click:t.startTalking}},[t._v("开始录音")]):t._e(),t._v(" "),t.isShowBroadcastBtn||t.switchIcon?t._e():s("span",{staticClass:"stoping"},[t._v("录音中")]),t._v(" "),t.isShowBroadcastBtn&&t.switchIcon1?s("span",{staticClass:"start",on:{click:t.broadcastTalking}},[t._v("播放录音")]):t._e(),t._v(" "),t.isShowBroadcastBtn&&!t.switchIcon1?s("span",{staticClass:"stoping"},[t._v("播放中")]):t._e(),t._v(" "),s("span",{staticClass:"reset",on:{click:t.resetTalking}},[t._v("重置")])])])])]),t._v(" "),s("mt-datetime-picker",{ref:"applyDatePicker",attrs:{type:"date"},on:{confirm:t.applyDateConfirm},model:{value:t.applyDate,callback:function(e){t.applyDate=e},expression:"applyDate"}})],1)},staticRenderFns:[]};var g=i("C7Lr")(m,v,!1,function(t){i("501J")},null,null);e.default=g.exports},Jj7Z:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAAQCAYAAAAbBi9cAAAABHNCSVQICAgIfAhkiAAAATJJREFUOI2l078rxHEcx/EHR0RJuqyGS3SlRJlcOWGQblD+AINMyuJvMNjNMhssFuTXTBGDgQjT1ZEiFjF8P/Lt3DnHuz71en9+PPu8P6/3J+HvsYwWnP2DAVK4RSskftjYgXbcx+YasB5GPtwoi+1ykGE8IFdibQtLQbehgOZSkAW84T0GmkcmVtLTZ0nYxHgdhmKQOUyWgB9jFV24xAlGsIZdZOqCqBR7oocdxQYO0BdA18jV/gISv1VP0HdIBl1AshpQK56DbsJr0I14+S2oBgMix4ha4yroJPK1oj7IiizfKQOaxQ3OQz6G/aB7cVh8IIFFkfVx+/t9vUkWR7Ezh+guV8oEHn1vyHpcYDDkaZyWg3xGCp1Fcw2YiuUrmKkEqhRDop+fgGrsL440pkXfyQfDFTiEaUH0+AAAAABJRU5ErkJggg=="},bimD:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAB8UlEQVRIS+3WS6gNUBTG8d8tUh6hJBIGJM8ojzBCoRQmRiQmKAMyITL1KqWYKBKKgSGZGRgwEMojitDteiQDjxBlQEvr1Ok4r326usnddTp12mv9z/7W2t/aXfpodfUR1z8FHo5dmJNq3cMxfCpRr/TEU3ANA3AZb7EI07AEL9qFl4AD9gBfsQIfqiDnMAFL/wZ4Lu5gKp7UAEbiPWbgcTvwkhNvwkGMa5D4FfbhfG+Dt2IPJjVIHPU9hFP94HoKlNS4X+paBXutuaIM63EhCaVSb8BF/Cyt8UR0I757sA4nMarBdQkn24ZLGJ8xldg/Qpo11+C0x+Xpz2PwBjPruNMqXMVkPE//vokh+FZ64tgfFhkJdmbwCSzEyrTI+HkBruAW1uS+/ViL+Y3MpNV12oEDKd1HDM26zcNTjM7JFOCo6WfE2AwvD3s93il4YE6kZ3maSqMsw3R+PyQe4noV4AwWYxZ+dAqOuKhpyHgDG/GuQbL4EzEk4hPyP2rm2a2krsSGtCHnIBzFbdzNOo/AZmzHMKzO3mg6K9oFR5JIuhsxHuO6VK+XOIsjeRNaDqgScHWymMmn0xy24HVLUs2GTsGRJgZ+NFsoULw6Ac9GPHX2Jvhwvr/ul9BLweFEX+oA4o6Pxfd24aXgdvO23Pf/gX8BD0tqH2KUDQoAAAAASUVORK5CYII="}});
//# sourceMappingURL=4.21624b660d225f0b1d02.js.map
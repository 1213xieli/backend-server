webpackJsonp([5],{Dor1:function(t,e){},uFDv:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAElklEQVRYR8WYXUwcVRTH/2cWkBYBU6hAQ9vpnQUbiSwkPpg+mGL6YsTExqZRUxs1sdqnVpoGosZitFaD2qbGB32osTG2aI1NiPFJDUZNTZrAorHQ3ZnlyxKUIBYWKLD3mBm6COvOzsdCnWSe5pz/+c059577QfD5dAlRRUAjiO4jpnKAK0BUYcox8wiBRkA8wsw/5xJ11Oh61E8o8uL0q6qWSyXnsATvJqJqL75g7mPQxQAnTt4Ti4269XUF2FtaWnijuLgFTIdAKHArbmM3xZJPFQSorSoave6k5QjYo2pPcYDeBlDiJObx+xizbK4zjDOZ/GwBGaCwprUR6IjHwN7MJbfVxvRmAjidY1rA71Q1f4OS8wkIj3qL5tOacaFILjy5rb9/NlUhLWBYaOdA9JjPcP7cmM+FDP0JR8DwtuCLUHDcX5TsvJhlS51hvLVcZUUGu1TtEUXBFyBSsgvl05s5ISX21PfrF5MKS4CRYLAoztAJKPUpvypuDIzR1KQaGh2Nm4JLgGERPAZCa6YohQ07IWdmEb90yTdMyb59mOzsxNzQkK0GgV+p1fXXlgAvb9pUmpO/LkpExXZe+TU1CLafN9cxxJ494Aty43MHUHH0KOYGh3C1sRFyejp9OOaJ+NwNbcfw8LiVwbAQrSDlWMaGmZuLLe+dRvGuXZAzM54hk3BmjJG2Nvz5wYcZq5DM4k3AYBcIdU51I5+QXuEsDkZ3yIjWU5eqqooSMEDkuOxZY8IjpC84C5BZyoSgsBCHQMopp+yt6E0uIX3DJYOxPGyutx8DtN8LoJtMZg23WOezFBbaNyB6wCtgJsjVgbPK/C2FRfAKCNv9AKaD/KujAyV791pybmZrxs4B/EbdQvubiIr8AqZCJnWyhVusME+sCqCpdefBgyg/0mTpyvl5xJ5+xlczX54oZr5ujsE+eD1fpKR7+ZibjUSQX1Xlq5n/p4rMV80x2AnC/X5LnDohxs58lNWKs4KD8T31aFo7gxZHtcfHbrZ6bea2YZnPU48QzUzKmx7Z4NRKVgXSbNSXVXV7biDnihdAJ7ikVlaQyaXOFPPSC93CZQ2Z3CyYQt0ieIIILU5Z9AqXFSTL1pBhvGrtYH6qrNxQkHebDqI77CDX19cj+Pln1mc/TXh5uRfGx9G7s8H9htUqs4vTXFnTC5DxuONm0+4nTcjN776D8fZ2TP3wo33BJF4KxaJvmAb/nknKygq44PYI3byhcir3Gn7/fX5muvrea9es88CKTWrPVu1BGUAHEQXWEMBemjlBiYWHawcGvl4av6nW3UK0ECkn/g9Ax4N7EiostE9B9PgthXR79WFCDVVWrhvPyzsLUvbcEkiWF+Jzc/t3DA/PpMbLeFCyyg06vmZXIcwJBr9cZxi2S63jSe4XIR6SoPdBtHVVs8k8SAk8XzugL02IdPqOgKaTdV9IOU1QrNWmMEvQSZng1yeQON2Q5j7QU4lTjSPlwY3x9bKJQLtBdJcnUOY+An/JRCdDuv6HW19XGUwn1i2EecvfqBBVM2MLCJsB67XmmfkSMMjMvbnAV3cbRsQt1HK7fwBajWW1B/fdIgAAAABJRU5ErkJggg=="},vPsL:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("4YfN"),s=i.n(a),n=i("3cXf"),o=i.n(n),c=i("X1H5"),u=i.n(c),d=i("teIl"),r=i("pzWD"),h=i("w3CS"),l=i("y6zN"),m=i("+MaT"),v=i("wSez"),b=i("UNpN"),g=i("9rMa"),p={name:"deepApplication",mixins:[i("PnOK").a],components:{SubmitBtn:r.a,myHeader:d.a},data:function(){return{batchNum:"",batchId:"",switchBatchNumPopup:!1,batchNumSlots:[{values:[{id:"",name:"",birthDay:""}],textAlign:"center"}],deadDate:new Date,deadDateText:Object(l.a)(new Date,"yyyy-MM-dd"),deadDay:"",dieDay:"",birthDay:"",deedNumber:"",deepWeight:"",actualDeedNumber:"",longitude:"",dimension:"",sheetVisible:!1,actions:[],currentPhotoInfo:{},showBigImage:!1,bigImageSrc:"",photoList:[],serverId:[]}},created:function(){this._getBatchNumberList()},mounted:function(){this.initWxConfig(),this.getLocation()},methods:{_getBatchNumberList:function(){var t=this;v.Indicator.open({text:"加载中...",spinnerType:"fading-circle"}),Object(b.d)().then(function(e){v.Indicator.close(),t.batchNumSlots[0].values=e.data.map(function(t,e){return{name:t.name,id:t.id,birthDay:t.birthday}}),console.log("test",t.batchNumSlots[0].values),t.batchNum=t.batchNumSlots[0].values[0].name,t.batchId=t.batchNumSlots[0].values[0].id,t.birthDay=t.batchNumSlots[0].values[0].birthday,Object(b.g)(e.data[0].birthday,t.deadDateText).then(function(e){t.deadDay=e.data}).catch(function(t){})},function(t){v.Indicator.close()})},selectBatchNum:function(){console.log(this.$refs.batchPicker.getValues()),this.batchNumSlots[0].values[0].name?this.switchBatchNumPopup=!this.switchBatchNumPopup:this.$toast({message:"无可选批次，请核实业务场景！",duration:1e3})},handleBatchConfirm:function(){var t=this;this.batchNum=this.$refs.batchPicker.getValues()[0].name,this.batchId=this.$refs.batchPicker.getValues()[0].id,this.birthDay=this.$refs.batchPicker.getValues()[0].birthDay,console.log(this.$refs.batchPicker.getValues()),Object(b.g)(this.birthDay,this.deadDateText).then(function(e){t.deadDay=e.data}).catch(function(t){}),this.switchBatchNumPopup=!1},selectDeadDate:function(){this.$refs.deadPicker.open()},deadDateConfirm:function(t){var e=this;console.log(this.deadDate),this.deadDateText=Object(l.a)(this.deadDate,"yyyy-MM-dd"),Object(b.g)(this.birthDay,this.deadDateText).then(function(t){e.deadDay=t.data}).catch(function(t){})},handlerDeedNumberLimit:function(t){this.deedNumber=Object(h.a)(t)},handlerDeepWeightLimit:function(t){this.deepWeight=Object(h.a)(t,1)},getBase64ByLocalId:function(t){var e=this;u.a.getLocalImgData({localId:t.toString(),success:function(t){e.currentPhotoInfo.src=t.localData,e.uploadImg()}})},addPhoto:function(){if(this.photoList.length>=4)return this.$toast("照片不能多于四张！"),!1;this.takePhoto()},takePhoto:function(){var t=this;u.a.ready(function(){u.a.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["camera","album"],success:function(e){var i=e.localIds;t.currentPhotoInfo.loadId=i,1===Object(m.a)()?(t.currentPhotoInfo.src=i,t.uploadImg()):2===Object(m.a)()&&t.getBase64ByLocalId(i)}})})},uploadImg:function(){var t=this;u.a.uploadImage({localId:this.currentPhotoInfo.loadId.toString(),isShowProgressTips:1,success:function(e){var i=t.currentPhotoInfo;i.serviceId=e.serverId,t.currentPhotoInfo={},t.photoList.push(i),t.serverId.push(e.serverId),t.$toast({message:"上传成功!",duration:2e3})},fail:function(e){this.$toast("上传失败:"+o()(e)),t.currentPhotoInfo={}}})},deletePhoto:function(t){var e=this;v.MessageBox.confirm("确定执行此操作?").then(function(i){e.photoList.splice(t,1),e.serverId.splice(t,1)})},_checkData:function(){var t=[{val:this.batchNum,rule:["required"],getTipText:"批次号"},{val:this.deedNumber,rule:["required"],getTipText:"死亡头数"},{val:this.deepWeight,rule:["required"],getTipText:"死亡均重"}];return Object(h.b)(t)},_submitData:function(){var t=this,e={batchId:this.batchId,batchNo:this.batchNum,dieDate:this.deadDateText,dieDay:this.deadDay,applyDieCnt:this.deedNumber,dieAvg:this.deepWeight,latitude:this.dimension,longitude:this.longitude,serverIds:this.serverId};Object(b.o)(e).then(function(e){t.$toast({message:"提交成功！",duration:1e3}),t.$router.push("/deadApplicationRecord")}).catch(function(e){t.isDisabledSubmit=!1,t.submitBtnText="提交"})},submitPage:function(){return!!this._checkData()&&(this.photoList.length<2?(this.$toast("至少2张多角度照片！"),!1):this.photoList.length>4?(this.$toast("照片不能多于四张！"),!1):void(this.isDisabledSubmit||(this.isDisabledSubmit=!0,this.submitBtnText="提交中...",this._submitData())))},initWxConfig:function(){u.a.config({debug:!1,appId:this.signature.appId,timestamp:this.signature.timestamp,nonceStr:this.signature.nonceStr,signature:this.signature.signature,jsApiList:["chooseImage","getLocation","getNetworkType","uploadImage","previewImage"]})},getLocation:function(){var t=this;u.a.ready(function(){u.a.getLocation({type:"wgs84",success:function(e){t.dimension=Math.floor(1e7*e.latitude)/1e7,t.longitude=Math.floor(1e7*e.longitude)/1e7}})})}},computed:s()({},Object(g.b)(["signature"]))},f={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"feedlist",staticStyle:{"max-width":"100%","box-sizing":"border-box"}},[a("myHeader",{attrs:{isBack:!0,backPath:"/business",title:"死亡申报",subtitle:"记录",subtitlePath:"/deadApplicationRecord"}}),t._v(" "),a("div",{staticClass:"mt4 list-block"},[a("mt-cell",{attrs:{title:"批次号："},nativeOn:{click:function(e){return t.selectBatchNum(e)}}},[t._v("\n      "+t._s(t.batchNum)+"\n      "),a("span",{staticClass:"img"})]),t._v(" "),a("mt-cell",{attrs:{title:"死亡日期："},nativeOn:{click:function(e){return t.selectDeadDate(e)}}},[a("span",{staticClass:"color-text"},[t._v(t._s(t.deadDateText))]),t._v(" "),a("span",{staticClass:"img"})]),t._v(" "),a("mt-cell",{attrs:{title:"死亡日龄："}},[t._v(t._s(t.deadDay)+"天")]),t._v(" "),a("mt-cell",{attrs:{title:"申报死亡头数："}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.deedNumber,expression:"deedNumber"}],attrs:{type:"text",placeholder:"请输入死亡头数"},domProps:{value:t.deedNumber},on:{input:[function(e){e.target.composing||(t.deedNumber=e.target.value)},t.handlerDeedNumberLimit]}}),t._v("头\n    ")]),t._v(" "),a("mt-cell",{attrs:{title:"死亡均重："}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.deepWeight,expression:"deepWeight"}],attrs:{type:"text",placeholder:"请输入死亡均重"},domProps:{value:t.deepWeight},on:{input:[function(e){e.target.composing||(t.deepWeight=e.target.value)},t.handlerDeepWeightLimit]}}),t._v("kg\n    ")]),t._v(" "),a("div",{staticClass:"longitude mint-cell"},[a("div",{staticClass:"width50 left"},[a("span",[t._v("经度：")]),t._v(" "),a("span",[t._v(t._s(t.longitude))])]),t._v(" "),a("div",{staticClass:"width50 left"},[a("span",[t._v("纬度：")]),t._v(" "),a("span",[t._v(t._s(t.dimension))])])]),t._v(" "),a("div",{staticClass:"photo-info"},[a("div",{staticClass:"devied"}),t._v(" "),a("mt-cell",{attrs:{title:"死亡猪只拍照："}}),t._v(" "),a("div",{staticClass:"photo-body"},[t._l(t.photoList,function(e,s){return a("div",{staticClass:"photoItem"},[a("img",{staticClass:"imgStyle",attrs:{src:e.src}}),t._v(" "),a("span",{staticClass:"delete-photo",on:{click:function(e){return t.deletePhoto(s)}}},[a("img",{attrs:{src:i("uFDv")}})])])}),t._v(" "),a("div",{staticClass:"tabke-photo",on:{click:t.addPhoto}},[a("img",{attrs:{src:i("xpjE"),alt:""}})])],2)],1),t._v(" "),a("SubmitBtn",{attrs:{btnText:t.submitBtnText,customStyle:t.myCustomStyle},nativeOn:{click:function(e){return t.submitPage(e)}}})],1),t._v(" "),a("div",{staticClass:"my-prop"},[a("mt-popup",{attrs:{position:"bottom"},model:{value:t.switchBatchNumPopup,callback:function(e){t.switchBatchNumPopup=e},expression:"switchBatchNumPopup"}},[a("mt-picker",{ref:"batchPicker",attrs:{slots:t.batchNumSlots,"value-key":"name","show-toolbar":!0}},[a("span",{staticClass:"sure-btn",on:{click:t.handleBatchConfirm}},[t._v("确认")])])],1)],1),t._v(" "),a("mt-datetime-picker",{ref:"deadPicker",attrs:{type:"date"},on:{confirm:t.deadDateConfirm},model:{value:t.deadDate,callback:function(e){t.deadDate=e},expression:"deadDate"}})],1)},staticRenderFns:[]};var A=i("C7Lr")(p,f,!1,function(t){i("Dor1")},"data-v-40f330b9",null);e.default=A.exports},xpjE:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALQAAAC0CAYAAAA9zQYyAAAGpUlEQVR4Xu3cP4vcVRTG8Xt/jinSLDOwTSobMRgQhe3to4UvwiYLEmzF2sImQUgI+CqEYKEvQrEwEWGxSrPMDMuSLZw4R2YxGhchmznzPHNwvukW5v7hc78cNlNsbxf+HR8fvzUMw61hGD6IiGuttasXP8PPCGxLICLOeu9PIuLhcrl8sL+//8uLd+nPf4iI12az2ZfDMHwSEa9v68Kci8BlBXrvi4i4Mx6PP+u9/7Fadx50RIzm8/k3rbWbl92MzyFQSODbo6Ojjw4ODhbnQU+n07u999uFLshVEHglgd773fF4/GmfTqc3eu8/ttZGr7QDH0aglsCziHi3z2aze621w1p34zYIrCVwfxX0o9ba9bWWswiBWgKPV0E/5au5Wq/CbdYWOFsFHWsvZyECxQQIutiDcJ2cAEHn/FhdTICgiz0I18kJEHTOj9XFBAi62INwnZwAQef8WF1MgKCLPQjXyQkQdM6P1cUECLrYg3CdnABB5/xYXUyAoIs9CNfJCRB0zo/VxQQIutiDcJ2cAEHn/FhdTICgiz0I18kJEHTOj9XFBAi62INwnZwAQef8WF1MgKCLPQjXyQkQdM6P1cUECLrYg3CdnABB5/xYXUyAoIs9CNfJCRB0zo/VxQQIutiDcJ2cAEHn/FhdTICgiz0I18kJEHTOj9XFBAi62INwnZwAQef8WF1MgKCLPQjXyQkQdM6P1cUECLrYg3CdnABB5/xYXUyAoIs9CNfJCRB0zo/VxQQIutiDcJ2cAEHn/FhdTICgiz0I18kJEHTOj9XFBAi62INwnZwAQef8WF1MgKCLPQjXyQkQdM6P1cUECLrYg3CdnABB5/xYXUyAoIs9CNfJCRB0zo/VxQQIutiDcJ2cAEHn/F66+oeff/vXZ957+42XruED6wsQ9Pp2l1pJ0Jdi2tiHCHpjlP+9EUGLgS9sT9Bib4IWAxO0F5igvd5MaLE3QYuBmdBeYIL2ejOhxd4ELQZmQnuBCdrrzYQWexO0GJgJ7QUmaK83E1rsTdBiYCa0F5igvd5MaLE3QYuBmdBeYIL2ejOhxd4ELQZmQnuBCdrrzYQWexO0GJgJ7QUmaK83E1rsTdBiYCa0F5igvd5MaLE3QYuBmdBeYIL2ejOhxd4ELQZmQnuBCdrrzYQWexO0GJgJ7QUmaK83E1rsTdBiYCa0F5igvd5MaLE3QYuBd3VCXwzLy7z903blr57uzIQm6N34M74Evf3habkBE9rC7DuECc2E9tX2Pz6J/xR6H3dnfuXwsv5zGkF75Qla7E3QYuBd/drOy8qE3pY3E1osz4QWAzOhvcAE7fVmQou9CVoMzIT2AhO015sJLfYmaDEwE9oLTNBebya02JugxcBMaC8wQXu9mdBib4IWAzOhvcAE7fVmQou9CVoMzIT2AhO015sJLfYmaDEwE9oLTNBebya02JugxcBMaC8wQXu9mdBib4IWAzOhvcAE7fVmQou9CVoMzIT2AhO015sJLfYmaDEwE9oLTNBebya02JugxcBMaC8wQXu9mdBib4IWAzOhvcAE7fVmQnu9OU0sQNBiYLb3ChC015vTxAIELQZme68AQXu9OU0sQNBiYLb3ChC015vTxAIELQZme68AQXu9OU0sQNBiYLb3ChC015vTxAIELQZme68AQXu9OU0sQNBiYLb3ChC015vTxAIELQZme68AQXu9OU0sQNBiYLb3ChC015vTxAIELQZme68AQXu9OU0sQNBiYLb3ChC015vTxAIELQZme68AQXu9OU0sQNBiYLb3ChC015vTxAIELQZme68AQXu9OU0sQNBiYLb3ChC015vTxAIELQZme68AQXu9OU0sQNBiYLb3ChC015vTxAIELQZme68AQXu9OU0sQNBiYLb3ChC015vTxAIELQZme68AQXu9OU0sQNBiYLb3ChC015vTxAIELQZme68AQXu9OU0sQNBiYLb3ChC015vTxAIELQZme68AQXu9OU0sQNBiYLb3CqyCftpau+o9ltMQkAicrYJ+1Fq7LtmeTRHwCjxeBX2vtXboPZfTENi8QER81U9PT28sFoufWmvD5o9gRwRsAsuIeKevjpvP519HxMe2ozkIgc0LPJhMJrfOg46IK9Pp9LthGN7f/DnsiIBWICK+n0wmN3vvz86D/ivq0Xw+/6K1dru1dkV7BXZHYCMCv7fW7ozH489XMa92/Dvo59ufnJy8uVwuDyPiw4i41nvnK72N2LPJhgTOeu9Plsvlw9FodH9vb+/XF/f9EzX7xgE62kEkAAAAAElFTkSuQmCC"}});
//# sourceMappingURL=5.6b8e9952f4f56cc90b65.js.map